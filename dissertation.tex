\documentclass[pdftex,12pt,a4paper]{report}


% Some useful packages.
\usepackage{amsmath}
\usepackage{siunitx}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage{mhchem}
\usepackage{textcomp}
\usepackage{setspace}

% Reduces margins substantially.
\usepackage{geometry}
\newgeometry{margin=3.0cm}

% Allows headers and footers.
\usepackage{fancyhdr}
\pagestyle{fancy}
% Get rid of annoying line under header.
\renewcommand{\headrulewidth}{0pt}

% Temporary fix for missing font problem.
\renewcommand{\textdegree}{$^{\circ}$ } % N.B. I know this is wrong, but there's a problem with missing fonts otherwise.

\lhead{}
\chead{}
\rhead{}

\newcommand{\ts}{\textsuperscript}
\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}

% Harvard style references.
\usepackage[backend=biber,style=authoryear,sorting=nyt,dashed=false]{biblatex}
\renewcommand*{\nameyeardelim}{\addcomma\space}
\addbibresource{references/references.bib} % note the .bib is required

%\newcommand{\coo}{\ce{CO2}}

% 12,000 words max.

% overall structure:
% Abstract
% Intro
% Methods
% Results
% Conclustion
% Appendices
% References

% Rem: \lp
% TODO: get \lp working again!
% WG1AR5_ALL_FINAL
% WG1AR5_AnnexI_FINAL
% WG1AR5_Chapter02_FINAL: Observations: Atmosphere and Surface
% WG1AR5_Chapter06_FINAL: Carbon and Other Biogeochemical Cycles
% WG1AR5_Chapter08_FINAL: Anthropogenic and Natural Radiative Forcing
% WG1AR5_Chapter09_FINAL: Evaluation of Climate Models
% WG1AR5_Chapter14_FINAL: Climate Phenomena and their Relevance for Future Regional Climate Change
% WG1AR5_SPM_FINAL
% WG1AR5_TS_FINAL
% SREX-All_FINAL
% ar4_wg1_full_report
% RCP_Guide
% SREX-Ch3-Supplement_FINAL

\title{Objective Tracking and Categorisation of Hurricanes in the 20\ts{th} Century Reanalysis Dataset}
\author{Mark Muetzelfeldt - UCL Department of Geography}

\date{29 August, 2014}

% TODO: this is not working.
%\chead{Mark Muetzelfeldt - Objective Tracking and Categorisation of Hurricanes}

\begin{document}


\input{./title.tex}

% Should be ~400 words.
% Not included in word count.
\onehalfspacing
\section*{Abstract}

From an ...

\begin{center}
\textbf{Word count:} XXX
\end{center}

\section*{Acknowledgements}

I would like to thank Dr. Chris Brierley for his guidance and assistance in this dissertation.
Technical expertise from Qinling Wu proved useful in setting the direction for this project. 
Talking to Joshua Studholme helped to provide context for the field and ideas for analysis. % CLUMSY
Meeting Dr. Kevin Hodges (Reading University) was useful for [tracking help]. 
Finally, numerous discussions with Robert Muetzelfeldt were invaluable for keeping me on track and sounding out various ideas.

\newpage


\tableofcontents

% Everything from here to auto-critique is included in word count.
\chapter{Introduction}
% Introduction, presenting the research problem, rationale, context and outline objectives, aims/objectives (possibly as a formal hypothesis).

\section{Research Problem}

However \textcite{walshObjective1997} have found that \dots

\subsection{Rationale}

\subsection{Context}

\chapter{Methods}
% Methods, including data sources and acquisition, data processing.

\section{Data Sources}

\subsection{20th Century Reanalysis Project}
The 20th Century Reanalysis Project (20CRP) is a project whose aim is to produce a best estimate of the state of the atmosphere by including informations from a variety of different sources using data assimilation \parencite{compoTwentieth2011}.

\subsection{IBTrACS Best Tracks Dataset}
The International Best Track Archive for Climate Stewardship (IBTrACS) \parencite{knappInternational2010} is a 

\section{Data Processing}

\subsection{Wind Fields and Vorticity}

In the 20CRP data, the longitudinal and latitudinal wind fields, $u$ and $v$ respectively, were used to calculate the vorticity and wind speeds. These are available at three different pressure levels: \SI{995}{hPa}, \SI{850}{hPa} and \SI{250}{hPa}. The \SI{250}{hPa} fields were only used to determine whether or not they were suitable for tracking of hurricanes, and it was found that they did not produce suitable tracks, and were not further used (see Section \ref{sec:results_tracking}). The formula for vorticity, $\omega$, is given by:

\begin{equation}
    \omega = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y}
    \label{eqn:vorticity}
\end{equation}

The surface of the earth, $R_e$, is taken as its mean radius of \SI{6371}{km}, and $\phi$, $\lambda$ denote the latitude and longitude coordinates. $u_{i, j}$ denotes the longitudinal wind speed at grid cell $i, j$. Then $\omega$ can approximated on the surface of the Earth using a 2\ts{nd} order approximation: %CLUMSY

% Calculation in code is a little different because it uses degrees instead of radians:
% More like vorticity = du / (2 * dlon * cos(lat * pi / 180) * Earth_circ / 360) - dv / ((2 * dlat) * Earth_circ / 360)

\begin{equation}
    \omega \approx \frac{\Delta v}{2 \Delta x} - \frac{\Delta u}{2 \Delta y} = \frac{v_{i,j+1} - v_{i,j-1}}{2 R_e \cos{\phi} \Delta \lambda} - \frac{u_{i+1,j} - u_{i-1,j}}{2 R_e \Delta \phi }
    \label{eqn:vorticity_2nd_order}
\end{equation}

The vorticities at the \SI{995}{hPa} and \SI{850}{hPa} levels were calculated.

\subsection{Maxima and Minima detection}
\label{sec:methods_maxima_minima}

For the vorticity fields, maxima are of primary interest as these represent grid cells where the wind is rotating most strongly. Conversely, for the PSL field, minima are of primary interest. A maxima or minima was defined as a cell whose value was greater or less than all eight of its surrounding cells. Vorticity maxima play a vital role in deriving tracks from the 20CRP data, and pressure minima are useful both for comparison with the best tracks data and categorisation of the tracks.

\subsection{Upscaling of data}

Following \textcite{TODOhodgesXXX}, the vorticity field was upscaled to a finer resolution. This was done so as when tracks were derived from these data, the so called ``staircase effect'', whereby tracks are seen to follow the grid cells at the resolution of the 20CRP data, was minimised. This upscaling was accomplished using a cubic spline interpolation, and the data were upscaled to two and three times their original resolutions. The efficacy of this upscaling will be demonstrated in Section \ref{sec:results_tracking}.

\section{Tracking}

From both initial experimentation, and reading the literature \parencite{TODOmultiple}, it was found that tracking on minima of the pressure field did not produce suitable tracks for identifying hurricane tracks. This was due to the pressure field being subject to synoptic scale disturbances that mean that minima may not be present due to the surrounding gradient of this field. Whilst it is possible to apply high pass filtering to remove these disturbances, it was decided to follow \textcite{TODOmutliple} and produce derived tracks from the 20CRP data based on vorticity maxima.

For each timestep, the vorticity maxima were produced, as per Section \ref{sec:methods_maxima_minima}. This was done for both the \SI{995}{hPa} and \SI{850}{hPa} pressure levels, and for the one, two and three times the actual 20CRP resolution, yielding a total of six possibly configurations for the tracking. These various configurations were compared, and the results can be seen in Section \ref{sec:results_tracking}.

The tracking algorithm used was a simple nearest neighbour tracking algorithm, with a modification that counted two vorticity maxima that were sufficiently close as belonging to the strongest of these maxima. This cutoff distance was set as eight times the distance between the cells at 0\textdegree N, or approximately \SI{1800}{km}. This distance was found to reduce problems of vorticity maxima merging and splitting. The algorithm worked as follows:

\begin{enumerate}
    \item Detect all vorticity maxima for the first timestep. If two maxima are less than the cutoff distance apart, combine both maxima, taking the strength and position of the strongest of the two maxima
    \item Make each of the vorticity maxima in the first timestep the beginning of a derived track (whose length could end up being only one)
    \item Detect all vorticity maxima in the second timestep, combining close weaker maxima into stronger.
    \item Calculate nearest neighbour in the second timestep to first timestep, and set this as the next member of the derived track
    \item Move onto the third timestep and repeat the process
\end{enumerate}

Whilst this algorithm is considerably less sophisticated that that of \textcite{hodges1994}, it was found to produce sufficiently good tracks to pick up most of the best tracks in the IBTrACS dataset, and almost all of the best tracks that were hurricanes (Section  \ref{sec:results_tracking}). A discussion of other tracking algorithms can be found in Section \ref{sec:discussion_tracking_algs}.

\chapter{Results}
% Data analysis and results.

\section{Tracking}
\label{sec:results_tracking}

\chapter{Discussion}

\section{Tracking Algorithms}
\label{sec:discussion_tracking_algs}.

\chapter{Conclusions}

% Not included in word count.
\addcontentsline{toc}{chapter}{Auto-critique}
\chapter*{Auto-critique}

% Harvard style bibliography.
\addcontentsline{toc}{chapter}{References}
\printbibliography[title={References}]

%\appendix 
%\section{Additional information}

\end{document}
